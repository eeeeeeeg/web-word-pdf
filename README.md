# Web Word PDF

ğŸš€ **åœ¨çº¿æ–‡æ¡£è®¾è®¡ä¸å¯¼å‡ºå·¥å…·**

åŸºäº Vue.js 2.6 çš„å¯è§†åŒ–æ–‡æ¡£ç¼–è¾‘å™¨ï¼Œæ”¯æŒæ‹–æ‹½å¼ç»„ä»¶ç¼–è¾‘ã€å¯Œæ–‡æœ¬ç¼–è¾‘ã€å¤šé¡µé¢ç®¡ç†å’Œæ–‡æ¡£å¯¼å‡ºåŠŸèƒ½ã€‚

![License](https://img.shields.io/badge/license-MIT-blue.svg)
![Vue](https://img.shields.io/badge/Vue.js-2.6-green.svg)
![TinyMCE](https://img.shields.io/badge/TinyMCE-8.0-blue.svg)
![Node](https://img.shields.io/badge/Node.js-16+-green.svg)

## âœ¨ æ ¸å¿ƒåŠŸèƒ½

### ğŸ“ å¯è§†åŒ–ç¼–è¾‘

- **æ‹–æ‹½å¼ç»„ä»¶**ï¼šæ–‡æœ¬ç»„ä»¶ã€å›¾ç‰‡ç»„ä»¶ã€è‡ªç”±æ–‡æœ¬ã€è‡ªç”±å›¾ç‰‡
- **å¯Œæ–‡æœ¬ç¼–è¾‘**ï¼šé›†æˆ TinyMCE 8.0 ç¼–è¾‘å™¨ï¼Œæ”¯æŒæ ¼å¼åŒ–æ–‡æœ¬
- **è‡ªç”±å®šä½**ï¼šæ”¯æŒè‡ªç”±æ‹–æ‹½å’Œç²¾ç¡®å®šä½
- **å®æ—¶é¢„è§ˆ**ï¼šæ‰€è§å³æ‰€å¾—çš„ç¼–è¾‘ä½“éªŒ

### ğŸ“„ é¡µé¢ç®¡ç†

- **å¤šé¡µé¢æ”¯æŒ**ï¼šåˆ›å»ºå’Œç®¡ç†å¤šä¸ªé¡µé¢
- **é¡µé¢å¯¼èˆª**ï¼šä¾¿æ·çš„é¡µé¢åˆ‡æ¢
- **é¡µçœ‰é¡µè„š**ï¼šå…¨å±€é¡µçœ‰é¡µè„šè®¾è®¡
- **è‡ªåŠ¨åˆ†é¡µ**ï¼šå†…å®¹è¶…å‡ºæ—¶è‡ªåŠ¨åˆ†é¡µå¤„ç†

### ğŸ¨ æ ·å¼é…ç½®

- **å…¨å±€æ ·å¼**ï¼šç»Ÿä¸€çš„é¡µé¢æ ·å¼è®¾ç½®
- **ç»„ä»¶æ ·å¼**ï¼šå­—ä½“ã€é¢œè‰²ã€å¯¹é½ç­‰æ ·å¼é…ç½®
- **å¸ƒå±€æ§åˆ¶**ï¼šç²¾ç¡®çš„ä½ç½®å’Œå°ºå¯¸æ§åˆ¶

### ï¿½ æ•°æ®ç®¡ç†

- **è‰ç¨¿ä¿å­˜**ï¼šæœåŠ¡å™¨ç«¯è‰ç¨¿ç®¡ç†
- **åˆ†äº«åŠŸèƒ½**ï¼šç”Ÿæˆåˆ†äº«é“¾æ¥è¿›è¡Œæ–‡æ¡£åˆ†äº«
- **å¯¼å‡ºåŠŸèƒ½**ï¼šæ”¯æŒ PDFã€Wordã€PPT æ ¼å¼å¯¼å‡º
- **æ•°æ®æŒä¹…åŒ–**ï¼šJSON æ ¼å¼çš„æ•°æ®å­˜å‚¨

## ğŸ› ï¸ æŠ€æœ¯æ¶æ„

### å‰ç«¯æŠ€æœ¯æ ˆ

```
Vue.js 2.6.14           # æ¸è¿›å¼JavaScriptæ¡†æ¶
Vue CLI 5.x             # é¡¹ç›®æ„å»ºå·¥å…·
TinyMCE 8.0.1           # å¯Œæ–‡æœ¬ç¼–è¾‘å™¨
@tinymce/tinymce-vue    # TinyMCE Vueç»„ä»¶
HTML5 Drag & Drop       # åŸç”Ÿæ‹–æ‹½API
Axios 1.11.0            # HTTPå®¢æˆ·ç«¯
HTML2Canvas 1.4.1       # æˆªå›¾ç”Ÿæˆ
jsPDF 3.0.1             # PDFç”Ÿæˆ
file-saver 2.0.5        # æ–‡ä»¶ä¸‹è½½
```

### åç«¯æŠ€æœ¯æ ˆ

```
Node.js 16+             # æœåŠ¡å™¨è¿è¡Œç¯å¢ƒ
Express 4.18.2          # Webæ¡†æ¶
Playwright 1.40.0       # æµè§ˆå™¨è‡ªåŠ¨åŒ–
docx 8.5.0              # Wordæ–‡æ¡£ç”Ÿæˆ
pptxgenjs 3.12.0        # PPTæ–‡æ¡£ç”Ÿæˆ
Sharp 0.34.3            # å›¾ç‰‡å¤„ç†
JSDOM 26.1.0            # DOMè§£æ
```

### é¡¹ç›®ç»“æ„

```
src/
â”œâ”€â”€ components/              # Vueç»„ä»¶
â”‚   â”œâ”€â”€ PageEditor.vue      # ä¸»ç¼–è¾‘å™¨
â”‚   â”œâ”€â”€ Canvas.vue          # ç”»å¸ƒç»„ä»¶
â”‚   â”œâ”€â”€ ComponentLibrary.vue # ç»„ä»¶åº“
â”‚   â”œâ”€â”€ PropertyPanel.vue   # å±æ€§é¢æ¿
â”‚   â”œâ”€â”€ RichTextEditor.vue  # å¯Œæ–‡æœ¬ç¼–è¾‘å™¨
â”‚   â”œâ”€â”€ FreeTextComponent.vue # è‡ªç”±æ–‡æœ¬ç»„ä»¶
â”‚   â”œâ”€â”€ ShareViewer.vue     # åˆ†äº«æŸ¥çœ‹å™¨
â”‚   â””â”€â”€ ...
â”œâ”€â”€ utils/                  # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ shareManager.js     # åˆ†äº«ç®¡ç†
â”‚   â”œâ”€â”€ exportManager.js    # å¯¼å‡ºç®¡ç†
â”‚   â”œâ”€â”€ schemaManager.js    # æ•°æ®æ¨¡å¼ç®¡ç†
â”‚   â”œâ”€â”€ autoPagination.js   # è‡ªåŠ¨åˆ†é¡µ
â”‚   â””â”€â”€ ...
â”œâ”€â”€ apis/                   # APIæ¥å£
â”œâ”€â”€ types/                  # ç±»å‹å®šä¹‰
â””â”€â”€ styles/                 # æ ·å¼æ–‡ä»¶

server/
â”œâ”€â”€ routes/                 # APIè·¯ç”±
â”‚   â”œâ”€â”€ export.js          # å¯¼å‡ºæ¥å£
â”‚   â”œâ”€â”€ share.js           # åˆ†äº«æ¥å£
â”‚   â””â”€â”€ drafts.js          # è‰ç¨¿æ¥å£
â”œâ”€â”€ services/              # ä¸šåŠ¡æœåŠ¡
â”‚   â”œâ”€â”€ PDFExportService.js # PDFå¯¼å‡ºæœåŠ¡
â”‚   â”œâ”€â”€ PPTExportService.js # PPTå¯¼å‡ºæœåŠ¡
â”‚   â””â”€â”€ DraftService.js    # è‰ç¨¿æœåŠ¡
â””â”€â”€ utils/                 # å·¥å…·å‡½æ•°
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Node.js 16.0+
- npm 8.0+
- ç°ä»£æµè§ˆå™¨ï¼ˆChrome 90+, Firefox 88+, Safari 14+ï¼‰

### å®Œæ•´å®‰è£…

```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/your-username/web-word-pdf.git
cd web-word-pdf

# å®‰è£…å‰ç«¯å’Œåç«¯ä¾èµ–
npm run setup
```

### å¼€å‘ç¯å¢ƒ

```bash
# å¯åŠ¨å‰ç«¯å¼€å‘æœåŠ¡å™¨
npm run serve
# è®¿é—® http://localhost:8080

# å¯åŠ¨åç«¯æœåŠ¡å™¨ï¼ˆæ–°ç»ˆç«¯ï¼‰
npm run server:dev
# æœåŠ¡è¿è¡Œåœ¨ http://localhost:3001
```

### ç”Ÿäº§æ„å»º

```bash
# æ„å»ºå‰ç«¯
npm run build

# å¯åŠ¨åç«¯æœåŠ¡
npm run server:start
```

### å¯ç”¨è„šæœ¬

```bash
npm run serve          # å¯åŠ¨å‰ç«¯å¼€å‘æœåŠ¡å™¨
npm run build          # æ„å»ºå‰ç«¯ç”Ÿäº§ç‰ˆæœ¬
npm run lint           # ä»£ç æ£€æŸ¥
npm run server:dev     # å¯åŠ¨åç«¯å¼€å‘æœåŠ¡å™¨
npm run server:start   # å¯åŠ¨åç«¯ç”Ÿäº§æœåŠ¡å™¨
npm run setup          # å®‰è£…æ‰€æœ‰ä¾èµ–
```

## ğŸ“– ä½¿ç”¨æŒ‡å—

### åŸºç¡€æ“ä½œ

1. **åˆ›å»ºé¡µé¢**ï¼šç‚¹å‡»"æ·»åŠ é¡µé¢"æŒ‰é’®åˆ›å»ºæ–°é¡µé¢
2. **æ·»åŠ ç»„ä»¶**ï¼šä»å·¦ä¾§ç»„ä»¶åº“æ‹–æ‹½ç»„ä»¶åˆ°ç”»å¸ƒ
   - æ–‡æœ¬ç»„ä»¶ï¼šç”¨äºæ·»åŠ å¯Œæ–‡æœ¬å†…å®¹
   - å›¾ç‰‡ç»„ä»¶ï¼šç”¨äºæ·»åŠ å›¾ç‰‡
   - è‡ªç”±æ–‡æœ¬ï¼šå¯è‡ªç”±å®šä½çš„æ–‡æœ¬ç»„ä»¶
   - è‡ªç”±å›¾ç‰‡ï¼šå¯è‡ªç”±å®šä½çš„å›¾ç‰‡ç»„ä»¶
3. **ç¼–è¾‘å†…å®¹**ï¼šåŒå‡»ç»„ä»¶è¿›å…¥ç¼–è¾‘æ¨¡å¼
4. **è°ƒæ•´æ ·å¼**ï¼šåœ¨å³ä¾§å±æ€§é¢æ¿ä¿®æ”¹æ ·å¼
5. **ä¿å­˜è‰ç¨¿**ï¼šç‚¹å‡»ä¿å­˜æŒ‰é’®ä¿å­˜åˆ°æœåŠ¡å™¨

### ç»„ä»¶åŠŸèƒ½

- **å¯Œæ–‡æœ¬ç¼–è¾‘**ï¼šæ”¯æŒç²—ä½“ã€æ–œä½“ã€é¢œè‰²ã€å¯¹é½ç­‰æ ¼å¼
- **è‡ªç”±å®šä½**ï¼šæ‹–æ‹½ç»„ä»¶åˆ°ä»»æ„ä½ç½®
- **å°ºå¯¸è°ƒæ•´**ï¼šæ‹–æ‹½è¾¹æ¡†è°ƒæ•´ç»„ä»¶å¤§å°
- **æ ·å¼é…ç½®**ï¼šå­—ä½“ã€é¢œè‰²ã€èƒŒæ™¯ç­‰æ ·å¼è®¾ç½®

### å¯¼å‡ºåŠŸèƒ½

- **PDF å¯¼å‡º**ï¼šç”Ÿæˆé«˜è´¨é‡ PDF æ–‡æ¡£
- **Word å¯¼å‡º**ï¼šç”Ÿæˆ DOCX æ ¼å¼æ–‡æ¡£
- **PPT å¯¼å‡º**ï¼šç”Ÿæˆ PowerPoint æ¼”ç¤ºæ–‡ç¨¿
- **åˆ†äº«é“¾æ¥**ï¼šç”Ÿæˆåœ¨çº¿åˆ†äº«é“¾æ¥

## ğŸ”§ æ ¸å¿ƒç‰¹æ€§

### ç»„ä»¶ç³»ç»Ÿ

- **æ¨¡å—åŒ–ç»„ä»¶**ï¼šCanvasã€PageEditorã€ComponentLibraryã€PropertyPanel
- **å¯Œæ–‡æœ¬ç¼–è¾‘**ï¼šåŸºäº TinyMCE 8.0 çš„å¯Œæ–‡æœ¬ç¼–è¾‘å™¨
- **è‡ªç”±å®šä½**ï¼šTransformController å®ç°ç»„ä»¶çš„æ‹–æ‹½å’Œç¼©æ”¾
- **æ•°æ®é©±åŠ¨**ï¼šåŸºäº JSON Schema çš„æ•°æ®æ¨¡å‹

### å¯¼å‡ºæœåŠ¡

- **PDF å¯¼å‡º**ï¼šä½¿ç”¨ Playwright ç”Ÿæˆé«˜è´¨é‡ PDF
- **Word å¯¼å‡º**ï¼šä½¿ç”¨ docx åº“ç”Ÿæˆ DOCX æ–‡æ¡£
- **PPT å¯¼å‡º**ï¼šä½¿ç”¨ pptxgenjs ç”Ÿæˆ PowerPoint æ–‡æ¡£
- **å›¾ç‰‡å¤„ç†**ï¼šä½¿ç”¨ Sharp è¿›è¡Œå›¾ç‰‡ä¼˜åŒ–

### æ•°æ®ç®¡ç†

- **è‰ç¨¿ç³»ç»Ÿ**ï¼šæœåŠ¡å™¨ç«¯è‰ç¨¿ä¿å­˜å’Œç®¡ç†
- **åˆ†äº«æœºåˆ¶**ï¼šåŸºäº URL çš„æ–‡æ¡£åˆ†äº«
- **è‡ªåŠ¨åˆ†é¡µ**ï¼šå†…å®¹è¶…å‡ºæ—¶çš„è‡ªåŠ¨åˆ†é¡µå¤„ç†
- **æ•°æ®æŒä¹…åŒ–**ï¼šJSON æ ¼å¼çš„æ•°æ®å­˜å‚¨

## ğŸ¯ æ ¸å¿ƒå®ç°

### ç»„ä»¶æ‹–æ‹½

```javascript
// TransformController å®ç°ç»„ä»¶å˜æ¢
export default {
  name: "TransformController",
  props: ["component", "selected", "mode"],
  methods: {
    handleMouseDown(event) {
      // æ‹–æ‹½å¼€å§‹é€»è¾‘
    },
    handleResize(direction, event) {
      // å°ºå¯¸è°ƒæ•´é€»è¾‘
    },
  },
};
```

### å¯Œæ–‡æœ¬ç¼–è¾‘

```javascript
// RichTextEditor é…ç½®
editorConfig: {
  base_url: "/tinymce",
  license_key: "gpl",
  inline: true,
  plugins: ["advlist", "autolink", "lists", "link", "image"],
  toolbar: "undo redo | formatselect | bold italic"
}
```

### è‡ªåŠ¨åˆ†é¡µ

```javascript
// è‡ªåŠ¨åˆ†é¡µç®—æ³•
function calculatePagination(components, pageHeight) {
  let currentPage = 0;
  let currentY = 0;

  return components.map((component) => {
    if (currentY + component.height > pageHeight) {
      currentPage++;
      currentY = 0;
    }
    currentY += component.height;
    return { ...component, page: currentPage };
  });
}
```

## ğŸ–¥ï¸ æœåŠ¡å™¨ç«¯

### Node.js æœåŠ¡æ¶æ„

åŸºäº Express çš„ RESTful API æœåŠ¡å™¨ï¼Œæä¾›æ–‡æ¡£å¯¼å‡ºå’Œæ•°æ®ç®¡ç†åŠŸèƒ½ï¼š

```
server/
â”œâ”€â”€ index.js              # æœåŠ¡å™¨å…¥å£
â”œâ”€â”€ routes/               # APIè·¯ç”±
â”‚   â”œâ”€â”€ export.js        # å¯¼å‡ºæ¥å£
â”‚   â”œâ”€â”€ share.js         # åˆ†äº«æ¥å£
â”‚   â”œâ”€â”€ drafts.js        # è‰ç¨¿æ¥å£
â”‚   â””â”€â”€ health.js        # å¥åº·æ£€æŸ¥
â”œâ”€â”€ services/            # ä¸šåŠ¡æœåŠ¡
â”‚   â”œâ”€â”€ PDFExportService.js   # PDFå¯¼å‡ºæœåŠ¡
â”‚   â”œâ”€â”€ PPTExportService.js   # PPTå¯¼å‡ºæœåŠ¡
â”‚   â””â”€â”€ DraftService.js      # è‰ç¨¿ç®¡ç†æœåŠ¡
â”œâ”€â”€ temp/                # ä¸´æ—¶æ–‡ä»¶å­˜å‚¨
â””â”€â”€ tests/               # æµ‹è¯•æ–‡ä»¶
```

### API æ¥å£

- **POST /api/export/pdf** - PDF å¯¼å‡º
- **POST /api/export/word** - Word å¯¼å‡º
- **POST /api/export/ppt** - PPT å¯¼å‡º
- **POST /api/drafts** - ä¿å­˜è‰ç¨¿
- **GET /api/drafts/:id** - è·å–è‰ç¨¿
- **POST /api/share** - åˆ›å»ºåˆ†äº«
- **GET /api/share/:id** - è·å–åˆ†äº«å†…å®¹

### æœåŠ¡å™¨éƒ¨ç½²

```bash
# å®‰è£…ä¾èµ–
cd server && npm install

# å®‰è£… Playwright æµè§ˆå™¨
npm run install-browsers

# å¼€å‘ç¯å¢ƒ
npm run dev

# ç”Ÿäº§ç¯å¢ƒ
npm start

# Docker éƒ¨ç½²
docker-compose up -d
```

## ğŸ“‹ ä¾èµ–è¯´æ˜

### å‰ç«¯æ ¸å¿ƒä¾èµ–

- **Vue.js 2.6.14** - ä¸»æ¡†æ¶
- **TinyMCE 8.0.1** - å¯Œæ–‡æœ¬ç¼–è¾‘å™¨
- **@tinymce/tinymce-vue 3.2.8** - TinyMCE Vue ç»„ä»¶
- **Axios 1.11.0** - HTTP è¯·æ±‚åº“
- **HTML2Canvas 1.4.1** - é¡µé¢æˆªå›¾
- **jsPDF 3.0.1** - PDF ç”Ÿæˆ
- **file-saver 2.0.5** - æ–‡ä»¶ä¸‹è½½

### åç«¯æ ¸å¿ƒä¾èµ–

- **Express 4.18.2** - Web æ¡†æ¶
- **Playwright 1.40.0** - æµè§ˆå™¨è‡ªåŠ¨åŒ–
- **docx 8.5.0** - Word æ–‡æ¡£ç”Ÿæˆ
- **pptxgenjs 3.12.0** - PPT æ–‡æ¡£ç”Ÿæˆ
- **Sharp 0.34.3** - å›¾ç‰‡å¤„ç†
- **JSDOM 26.1.0** - DOM è§£æ

## ğŸ¤ è´¡çŒ®æŒ‡å—

### å¼€å‘æµç¨‹

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/NewFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add NewFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/NewFeature`)
5. åˆ›å»º Pull Request

### ä»£ç è§„èŒƒ

- ä½¿ç”¨ ESLint è¿›è¡Œä»£ç æ£€æŸ¥
- éµå¾ª Vue.js å®˜æ–¹é£æ ¼æŒ‡å—
- ç»„ä»¶å‘½åä½¿ç”¨ PascalCase
- æ–¹æ³•å‘½åä½¿ç”¨ camelCase

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

â­ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™æˆ‘ä»¬ä¸€ä¸ªæ˜Ÿæ ‡ï¼
